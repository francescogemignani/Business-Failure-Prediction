aida.yy.value <- aida.yy[aida.yy$attribute == value,]
# Make a table: age <-> #failed/active companies (at specified year and a certain attribute value)
age.stat <- table(aida.yy.value[,c('Age','Failed')])
# Compute the conditional probability
# P(Failed=Yes | Age=x) = P(Failed=Yes,Age=x) / P(Age=x)
cond.tab <- (age.stat[,2] / (age.stat[,1]+age.stat[,2]) )
# Combine <age,#companies active, #companies failed, #all companies, P(Failed=Yes | Age=age)>
age.sum <- cbind(not.failed=age.stat[,1],
failed=age.stat[,2],
total=(age.stat[,1]+age.stat[,2]),
p.failed.knowing.age=cond.tab)
#Plot conditional probability
title <- paste("Year = ",year," ",attribute," = ",value)
barplot(age.sum[,4],main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'h',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'l',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
}
}
print(age.cond.prob(aida.age,year = 2018, attribute="Legal.form"))
age.cond.prob(aida.age,year = 2018, attribute="Legal.form")
age.cond.prob <- function(aida,year,attribute){
#Filter all companies at specified year
aida.yy <- aida[aida$Last.accounting.closing.date==year,]
#List of unique "attribute" values. "attribute" can be: Legal.form, ATECO.Sector.Name, Registered.office.address...Region
company.values <- unique(aida.yy$attribute)
table(aida.age.yy$attribute)
for( value in company.values) {
# Filter all companies with a certain "value" in "attribute"
aida.yy.value <- aida.yy[aida.yy$attribute == value,]
# Make a table: age <-> #failed/active companies (at specified year and a certain attribute value)
age.stat <- table(aida.yy.value[,c('Age','Failed')])
# Compute the conditional probability
# P(Failed=Yes | Age=x) = P(Failed=Yes,Age=x) / P(Age=x)
cond.tab <- (age.stat[,2] / (age.stat[,1]+age.stat[,2]) )
# Combine <age,#companies active, #companies failed, #all companies, P(Failed=Yes | Age=age)>
age.sum <- cbind(not.failed=age.stat[,1],
failed=age.stat[,2],
total=(age.stat[,1]+age.stat[,2]),
p.failed.knowing.age=cond.tab)
#Plot conditional probability
title <- paste("Year = ",year," ",attribute," = ",value)
barplot(age.sum[,4],main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'h',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'l',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
}
}
age.cond.prob(aida.age,year = 2018, attribute="Legal.form")
age.cond.prob <- function(aida,year,attribute){
#Filter all companies at specified year
aida.yy <- aida[aida$Last.accounting.closing.date==year,]
#List of unique "attribute" values. "attribute" can be: Legal.form, ATECO.Sector.Name, Registered.office.address...Region
company.values <- unique(aida.yy$attribute)
print(table(aida.age.yy$attribute))
for( value in company.values) {
# Filter all companies with a certain "value" in "attribute"
aida.yy.value <- aida.yy[aida.yy$attribute == value,]
# Make a table: age <-> #failed/active companies (at specified year and a certain attribute value)
age.stat <- table(aida.yy.value[,c('Age','Failed')])
# Compute the conditional probability
# P(Failed=Yes | Age=x) = P(Failed=Yes,Age=x) / P(Age=x)
cond.tab <- (age.stat[,2] / (age.stat[,1]+age.stat[,2]) )
# Combine <age,#companies active, #companies failed, #all companies, P(Failed=Yes | Age=age)>
age.sum <- cbind(not.failed=age.stat[,1],
failed=age.stat[,2],
total=(age.stat[,1]+age.stat[,2]),
p.failed.knowing.age=cond.tab)
#Plot conditional probability
title <- paste("Year = ",year," ",attribute," = ",value)
barplot(age.sum[,4],main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'h',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'l',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
}
}
age.cond.prob(aida.age,year = 2018, attribute="Legal.form")
age.cond.prob(aida.age,year = 2018, attribute=Legal.form)
age.cond.prob <- function(aida,year,attribute){
#Filter all companies at specified year
aida.yy <- aida[aida$Last.accounting.closing.date==year,]
#List of unique "attribute" values. "attribute" can be: Legal.form, ATECO.Sector.Name, Registered.office.address...Region
company.values <- unique(aida.yy$attribute)
print(attribute)
for( value in company.values) {
# Filter all companies with a certain "value" in "attribute"
aida.yy.value <- aida.yy[aida.yy$attribute == value,]
# Make a table: age <-> #failed/active companies (at specified year and a certain attribute value)
age.stat <- table(aida.yy.value[,c('Age','Failed')])
# Compute the conditional probability
# P(Failed=Yes | Age=x) = P(Failed=Yes,Age=x) / P(Age=x)
cond.tab <- (age.stat[,2] / (age.stat[,1]+age.stat[,2]) )
# Combine <age,#companies active, #companies failed, #all companies, P(Failed=Yes | Age=age)>
age.sum <- cbind(not.failed=age.stat[,1],
failed=age.stat[,2],
total=(age.stat[,1]+age.stat[,2]),
p.failed.knowing.age=cond.tab)
#Plot conditional probability
title <- paste("Year = ",year," ",attribute," = ",value)
barplot(age.sum[,4],main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'h',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'l',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
}
}
age.cond.prob(aida.age,year = 2018, attribute=Legal.form)
age.cond.prob(aida.age,year = 2018, attribute='Legal.form')
age.cond.prob <- function(aida,year,attribute){
#Filter all companies at specified year
aida.yy <- aida[aida$Last.accounting.closing.date==year,]
#List of unique "attribute" values. "attribute" can be: Legal.form, ATECO.Sector.Name, Registered.office.address...Region
company.values <- unique(aida.yy$attribute)
print(aida.yy$attribute)
for( value in company.values) {
# Filter all companies with a certain "value" in "attribute"
aida.yy.value <- aida.yy[aida.yy$attribute == value,]
# Make a table: age <-> #failed/active companies (at specified year and a certain attribute value)
age.stat <- table(aida.yy.value[,c('Age','Failed')])
# Compute the conditional probability
# P(Failed=Yes | Age=x) = P(Failed=Yes,Age=x) / P(Age=x)
cond.tab <- (age.stat[,2] / (age.stat[,1]+age.stat[,2]) )
# Combine <age,#companies active, #companies failed, #all companies, P(Failed=Yes | Age=age)>
age.sum <- cbind(not.failed=age.stat[,1],
failed=age.stat[,2],
total=(age.stat[,1]+age.stat[,2]),
p.failed.knowing.age=cond.tab)
#Plot conditional probability
title <- paste("Year = ",year," ",attribute," = ",value)
barplot(age.sum[,4],main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'h',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'l',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
}
}
age.cond.prob(aida.age,year = 2018, attribute='Legal.form')
age.cond.prob <- function(aida,year,attribute){
#Filter all companies at specified year
aida.yy <- aida[aida$Last.accounting.closing.date==year,]
#List of unique "attribute" values. "attribute" can be: Legal.form, ATECO.Sector.Name, Registered.office.address...Region
company.values <- unique(aida.yy$attribute)
print(aida$attribute)
for( value in company.values) {
# Filter all companies with a certain "value" in "attribute"
aida.yy.value <- aida.yy[aida.yy$attribute == value,]
# Make a table: age <-> #failed/active companies (at specified year and a certain attribute value)
age.stat <- table(aida.yy.value[,c('Age','Failed')])
# Compute the conditional probability
# P(Failed=Yes | Age=x) = P(Failed=Yes,Age=x) / P(Age=x)
cond.tab <- (age.stat[,2] / (age.stat[,1]+age.stat[,2]) )
# Combine <age,#companies active, #companies failed, #all companies, P(Failed=Yes | Age=age)>
age.sum <- cbind(not.failed=age.stat[,1],
failed=age.stat[,2],
total=(age.stat[,1]+age.stat[,2]),
p.failed.knowing.age=cond.tab)
#Plot conditional probability
title <- paste("Year = ",year," ",attribute," = ",value)
barplot(age.sum[,4],main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'h',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'l',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
}
}
age.cond.prob(aida.age,year = 2018, attribute='Legal.form')
age.cond.prob <- function(aida,year,attribute){
aida$attribute
#Filter all companies at specified year
aida.yy <- aida[aida$Last.accounting.closing.date==year,]
#List of unique "attribute" values. "attribute" can be: Legal.form, ATECO.Sector.Name, Registered.office.address...Region
company.values <- unique(aida.yy$attribute)
for( value in company.values) {
# Filter all companies with a certain "value" in "attribute"
aida.yy.value <- aida.yy[aida.yy$attribute == value,]
# Make a table: age <-> #failed/active companies (at specified year and a certain attribute value)
age.stat <- table(aida.yy.value[,c('Age','Failed')])
# Compute the conditional probability
# P(Failed=Yes | Age=x) = P(Failed=Yes,Age=x) / P(Age=x)
cond.tab <- (age.stat[,2] / (age.stat[,1]+age.stat[,2]) )
# Combine <age,#companies active, #companies failed, #all companies, P(Failed=Yes | Age=age)>
age.sum <- cbind(not.failed=age.stat[,1],
failed=age.stat[,2],
total=(age.stat[,1]+age.stat[,2]),
p.failed.knowing.age=cond.tab)
#Plot conditional probability
title <- paste("Year = ",year," ",attribute," = ",value)
barplot(age.sum[,4],main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'h',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'l',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
}
}
age.cond.prob(aida.age,year = 2018, attribute='Legal.form')
age.cond.prob <- function(aida,year,attribute){
print(aida$attribute)
#Filter all companies at specified year
aida.yy <- aida[aida$Last.accounting.closing.date==year,]
#List of unique "attribute" values. "attribute" can be: Legal.form, ATECO.Sector.Name, Registered.office.address...Region
company.values <- unique(aida.yy$attribute)
for( value in company.values) {
# Filter all companies with a certain "value" in "attribute"
aida.yy.value <- aida.yy[aida.yy$attribute == value,]
# Make a table: age <-> #failed/active companies (at specified year and a certain attribute value)
age.stat <- table(aida.yy.value[,c('Age','Failed')])
# Compute the conditional probability
# P(Failed=Yes | Age=x) = P(Failed=Yes,Age=x) / P(Age=x)
cond.tab <- (age.stat[,2] / (age.stat[,1]+age.stat[,2]) )
# Combine <age,#companies active, #companies failed, #all companies, P(Failed=Yes | Age=age)>
age.sum <- cbind(not.failed=age.stat[,1],
failed=age.stat[,2],
total=(age.stat[,1]+age.stat[,2]),
p.failed.knowing.age=cond.tab)
#Plot conditional probability
title <- paste("Year = ",year," ",attribute," = ",value)
barplot(age.sum[,4],main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'h',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'l',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
}
}
age.cond.prob(aida.age,year = 2018, attribute='Legal.form')
age.cond.prob <- function(aida,year,attribute){
print(aida$Legal.form)
#Filter all companies at specified year
aida.yy <- aida[aida$Last.accounting.closing.date==year,]
#List of unique "attribute" values. "attribute" can be: Legal.form, ATECO.Sector.Name, Registered.office.address...Region
company.values <- unique(aida.yy$attribute)
for( value in company.values) {
# Filter all companies with a certain "value" in "attribute"
aida.yy.value <- aida.yy[aida.yy$attribute == value,]
# Make a table: age <-> #failed/active companies (at specified year and a certain attribute value)
age.stat <- table(aida.yy.value[,c('Age','Failed')])
# Compute the conditional probability
# P(Failed=Yes | Age=x) = P(Failed=Yes,Age=x) / P(Age=x)
cond.tab <- (age.stat[,2] / (age.stat[,1]+age.stat[,2]) )
# Combine <age,#companies active, #companies failed, #all companies, P(Failed=Yes | Age=age)>
age.sum <- cbind(not.failed=age.stat[,1],
failed=age.stat[,2],
total=(age.stat[,1]+age.stat[,2]),
p.failed.knowing.age=cond.tab)
#Plot conditional probability
title <- paste("Year = ",year," ",attribute," = ",value)
barplot(age.sum[,4],main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'h',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'l',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
}
}
age.cond.prob(aida.age,year = 2018, attribute='Legal.form')
age.cond.prob(aida.age,year = 2018, 'Legal.form')
age.cond.prob <- function(aida,year,attribute){
print(aida$attribute)
#Filter all companies at specified year
aida.yy <- aida[aida$Last.accounting.closing.date==year,]
#List of unique "attribute" values. "attribute" can be: Legal.form, ATECO.Sector.Name, Registered.office.address...Region
company.values <- unique(aida.yy$attribute)
for( value in company.values) {
# Filter all companies with a certain "value" in "attribute"
aida.yy.value <- aida.yy[aida.yy$attribute == value,]
# Make a table: age <-> #failed/active companies (at specified year and a certain attribute value)
age.stat <- table(aida.yy.value[,c('Age','Failed')])
# Compute the conditional probability
# P(Failed=Yes | Age=x) = P(Failed=Yes,Age=x) / P(Age=x)
cond.tab <- (age.stat[,2] / (age.stat[,1]+age.stat[,2]) )
# Combine <age,#companies active, #companies failed, #all companies, P(Failed=Yes | Age=age)>
age.sum <- cbind(not.failed=age.stat[,1],
failed=age.stat[,2],
total=(age.stat[,1]+age.stat[,2]),
p.failed.knowing.age=cond.tab)
#Plot conditional probability
title <- paste("Year = ",year," ",attribute," = ",value)
barplot(age.sum[,4],main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'h',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'l',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
}
}
age.cond.prob(aida.age,year = 2018, 'Legal.form')
age.cond.prob <- function(aida,year,attribute){
print(aida[attribute])
#Filter all companies at specified year
aida.yy <- aida[aida$Last.accounting.closing.date==year,]
#List of unique "attribute" values. "attribute" can be: Legal.form, ATECO.Sector.Name, Registered.office.address...Region
company.values <- unique(aida.yy$attribute)
for( value in company.values) {
# Filter all companies with a certain "value" in "attribute"
aida.yy.value <- aida.yy[aida.yy$attribute == value,]
# Make a table: age <-> #failed/active companies (at specified year and a certain attribute value)
age.stat <- table(aida.yy.value[,c('Age','Failed')])
# Compute the conditional probability
# P(Failed=Yes | Age=x) = P(Failed=Yes,Age=x) / P(Age=x)
cond.tab <- (age.stat[,2] / (age.stat[,1]+age.stat[,2]) )
# Combine <age,#companies active, #companies failed, #all companies, P(Failed=Yes | Age=age)>
age.sum <- cbind(not.failed=age.stat[,1],
failed=age.stat[,2],
total=(age.stat[,1]+age.stat[,2]),
p.failed.knowing.age=cond.tab)
#Plot conditional probability
title <- paste("Year = ",year," ",attribute," = ",value)
barplot(age.sum[,4],main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'h',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'l',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
}
}
age.cond.prob(aida.age,year = 2018, 'Legal.form')
age.cond.prob <- function(aida,year,attribute){
#Filter all companies at specified year
aida.yy <- aida[aida$Last.accounting.closing.date==year,]
#List of unique "attribute" values. "attribute" can be: Legal.form, ATECO.Sector.Name, Registered.office.address...Region
company.values <- unique(aida.yy[attribute])
for( value in company.values) {
# Filter all companies with a certain "value" in "attribute"
aida.yy.value <- aida.yy[aida.yy[attribute] == value,]
# Make a table: age <-> #failed/active companies (at specified year and a certain attribute value)
age.stat <- table(aida.yy.value[,c('Age','Failed')])
# Compute the conditional probability
# P(Failed=Yes | Age=x) = P(Failed=Yes,Age=x) / P(Age=x)
cond.tab <- (age.stat[,2] / (age.stat[,1]+age.stat[,2]) )
# Combine <age,#companies active, #companies failed, #all companies, P(Failed=Yes | Age=age)>
age.sum <- cbind(not.failed=age.stat[,1],
failed=age.stat[,2],
total=(age.stat[,1]+age.stat[,2]),
p.failed.knowing.age=cond.tab)
#Plot conditional probability
title <- paste("Year = ",year," ",attribute," = ",value)
barplot(age.sum[,4],main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'h',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'l',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
}
}
age.cond.prob(aida.age,year = 2018, 'Legal.form')
age.cond.prob <- function(aida,year,attribute){
#Filter all companies at specified year
aida.yy <- aida[aida$Last.accounting.closing.date==year,]
#List of unique "attribute" values. "attribute" can be: Legal.form, ATECO.Sector.Name, Registered.office.address...Region
company.values <- unique(aida.yy[attribute])
for( value in company.values) {
# Filter all companies with a certain "value" in "attribute"
aida.yy.value <- aida.yy[aida.yy[attribute == value],]
# Make a table: age <-> #failed/active companies (at specified year and a certain attribute value)
age.stat <- table(aida.yy.value[,c('Age','Failed')])
# Compute the conditional probability
# P(Failed=Yes | Age=x) = P(Failed=Yes,Age=x) / P(Age=x)
cond.tab <- (age.stat[,2] / (age.stat[,1]+age.stat[,2]) )
# Combine <age,#companies active, #companies failed, #all companies, P(Failed=Yes | Age=age)>
age.sum <- cbind(not.failed=age.stat[,1],
failed=age.stat[,2],
total=(age.stat[,1]+age.stat[,2]),
p.failed.knowing.age=cond.tab)
#Plot conditional probability
title <- paste("Year = ",year," ",attribute," = ",value)
barplot(age.sum[,4],main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'h',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'l',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
}
}
age.cond.prob(aida.age,year = 2018, 'Legal.form')
age.cond.prob <- function(aida,year,attribute){
print(aida$attribute)
#Filter all companies at specified year
aida.yy <- aida[aida$Last.accounting.closing.date==year,]
#List of unique "attribute" values. "attribute" can be: Legal.form, ATECO.Sector.Name, Registered.office.address...Region
company.values <- unique(aida.yy$attribute)
for( value in company.values) {
# Filter all companies with a certain "value" in "attribute"
aida.yy.value <- aida.yy[aida.yy$attribute == value,]
# Make a table: age <-> #failed/active companies (at specified year and a certain attribute value)
age.stat <- table(aida.yy.value[,c('Age','Failed')])
# Compute the conditional probability
# P(Failed=Yes | Age=x) = P(Failed=Yes,Age=x) / P(Age=x)
cond.tab <- (age.stat[,2] / (age.stat[,1]+age.stat[,2]) )
# Combine <age,#companies active, #companies failed, #all companies, P(Failed=Yes | Age=age)>
age.sum <- cbind(not.failed=age.stat[,1],
failed=age.stat[,2],
total=(age.stat[,1]+age.stat[,2]),
p.failed.knowing.age=cond.tab)
#Plot conditional probability
title <- paste("Year = ",year," ",attribute," = ",value)
barplot(age.sum[,4],main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'h',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'l',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
}
}
age.cond.prob(aida.age,year = 2018, 'Legal.form')
age.cond.prob <- function(aida,year,attribute){
print(aida[attribute])
#Filter all companies at specified year
aida.yy <- aida[aida$Last.accounting.closing.date==year,]
#List of unique "attribute" values. "attribute" can be: Legal.form, ATECO.Sector.Name, Registered.office.address...Region
company.values <- unique(aida.yy[attribute])
for( value in company.values) {
# Filter all companies with a certain "value" in "attribute"
aida.yy.value <- aida.yy[(aida.yy[attribute]) == value,]
# Make a table: age <-> #failed/active companies (at specified year and a certain attribute value)
age.stat <- table(aida.yy.value[,c('Age','Failed')])
# Compute the conditional probability
# P(Failed=Yes | Age=x) = P(Failed=Yes,Age=x) / P(Age=x)
cond.tab <- (age.stat[,2] / (age.stat[,1]+age.stat[,2]) )
# Combine <age,#companies active, #companies failed, #all companies, P(Failed=Yes | Age=age)>
age.sum <- cbind(not.failed=age.stat[,1],
failed=age.stat[,2],
total=(age.stat[,1]+age.stat[,2]),
p.failed.knowing.age=cond.tab)
#Plot conditional probability
title <- paste("Year = ",year," ",attribute," = ",value)
barplot(age.sum[,4],main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'h',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'l',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
}
}
age.cond.prob(aida.age,year = 2018, 'Legal.form')
col = as.character(attribute)
age.cond.prob <- function(aida,year,attribute){
col = attribute
#Filter all companies at specified year
aida.yy <- aida[aida$Last.accounting.closing.date==year,]
#List of unique "attribute" values. "attribute" can be: Legal.form, ATECO.Sector.Name, Registered.office.address...Region
company.values <- unique(aida.yy$col)
for( value in company.values) {
# Filter all companies with a certain "value" in "attribute"
aida.yy.value <- aida.yy[(aida.yy$attribute) == value,]
# Make a table: age <-> #failed/active companies (at specified year and a certain attribute value)
age.stat <- table(aida.yy.value[,c('Age','Failed')])
# Compute the conditional probability
# P(Failed=Yes | Age=x) = P(Failed=Yes,Age=x) / P(Age=x)
cond.tab <- (age.stat[,2] / (age.stat[,1]+age.stat[,2]) )
# Combine <age,#companies active, #companies failed, #all companies, P(Failed=Yes | Age=age)>
age.sum <- cbind(not.failed=age.stat[,1],
failed=age.stat[,2],
total=(age.stat[,1]+age.stat[,2]),
p.failed.knowing.age=cond.tab)
#Plot conditional probability
title <- paste("Year = ",year," ",attribute," = ",value)
barplot(age.sum[,4],main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'h',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'l',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
}
}
age.cond.prob(aida.age,year = 2018, 'Legal.form')
age.cond.prob <- function(aida,year,attribute){
col = attribute
aida$col
#Filter all companies at specified year
aida.yy <- aida[aida$Last.accounting.closing.date==year,]
#List of unique "attribute" values. "attribute" can be: Legal.form, ATECO.Sector.Name, Registered.office.address...Region
company.values <- unique(aida.yy$col)
for( value in company.values) {
# Filter all companies with a certain "value" in "attribute"
aida.yy.value <- aida.yy[(aida.yy$attribute) == value,]
# Make a table: age <-> #failed/active companies (at specified year and a certain attribute value)
age.stat <- table(aida.yy.value[,c('Age','Failed')])
# Compute the conditional probability
# P(Failed=Yes | Age=x) = P(Failed=Yes,Age=x) / P(Age=x)
cond.tab <- (age.stat[,2] / (age.stat[,1]+age.stat[,2]) )
# Combine <age,#companies active, #companies failed, #all companies, P(Failed=Yes | Age=age)>
age.sum <- cbind(not.failed=age.stat[,1],
failed=age.stat[,2],
total=(age.stat[,1]+age.stat[,2]),
p.failed.knowing.age=cond.tab)
#Plot conditional probability
title <- paste("Year = ",year," ",attribute," = ",value)
barplot(age.sum[,4],main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'h',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'l',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
}
}
age.cond.prob(aida.age,year = 2018, 'Legal.form')
age.cond.prob <- function(aida,year,attribute){
col = attribute
print(aida$col)
#Filter all companies at specified year
aida.yy <- aida[aida$Last.accounting.closing.date==year,]
#List of unique "attribute" values. "attribute" can be: Legal.form, ATECO.Sector.Name, Registered.office.address...Region
company.values <- unique(aida.yy$col)
for( value in company.values) {
# Filter all companies with a certain "value" in "attribute"
aida.yy.value <- aida.yy[(aida.yy$attribute) == value,]
# Make a table: age <-> #failed/active companies (at specified year and a certain attribute value)
age.stat <- table(aida.yy.value[,c('Age','Failed')])
# Compute the conditional probability
# P(Failed=Yes | Age=x) = P(Failed=Yes,Age=x) / P(Age=x)
cond.tab <- (age.stat[,2] / (age.stat[,1]+age.stat[,2]) )
# Combine <age,#companies active, #companies failed, #all companies, P(Failed=Yes | Age=age)>
age.sum <- cbind(not.failed=age.stat[,1],
failed=age.stat[,2],
total=(age.stat[,1]+age.stat[,2]),
p.failed.knowing.age=cond.tab)
#Plot conditional probability
title <- paste("Year = ",year," ",attribute," = ",value)
barplot(age.sum[,4],main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'h',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'l',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
}
}
age.cond.prob(aida.age,year = 2018, 'Legal.form')
age.cond.prob <- function(aida,year,attribute){
print(aida$`attribute`)
#Filter all companies at specified year
aida.yy <- aida[aida$Last.accounting.closing.date==year,]
#List of unique "attribute" values. "attribute" can be: Legal.form, ATECO.Sector.Name, Registered.office.address...Region
company.values <- unique(aida.yy$col)
for( value in company.values) {
# Filter all companies with a certain "value" in "attribute"
aida.yy.value <- aida.yy[(aida.yy$attribute) == value,]
# Make a table: age <-> #failed/active companies (at specified year and a certain attribute value)
age.stat <- table(aida.yy.value[,c('Age','Failed')])
# Compute the conditional probability
# P(Failed=Yes | Age=x) = P(Failed=Yes,Age=x) / P(Age=x)
cond.tab <- (age.stat[,2] / (age.stat[,1]+age.stat[,2]) )
# Combine <age,#companies active, #companies failed, #all companies, P(Failed=Yes | Age=age)>
age.sum <- cbind(not.failed=age.stat[,1],
failed=age.stat[,2],
total=(age.stat[,1]+age.stat[,2]),
p.failed.knowing.age=cond.tab)
#Plot conditional probability
title <- paste("Year = ",year," ",attribute," = ",value)
barplot(age.sum[,4],main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'h',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
plot(age.sum[,4],type = 'l',main = title, xlab = 'Age', ylab = 'P(Failed=Yes | Age=x)' )
}
}
age.cond.prob(aida.age,year = 2018, attribute='Legal.form')
age.cond.prob(aida.age,year = 2018, attribute='Legal.form')
age.cond.prob(aida.age,year = 2018, 'Legal.form')
